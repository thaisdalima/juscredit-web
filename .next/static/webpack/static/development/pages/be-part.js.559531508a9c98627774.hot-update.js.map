{"version":3,"file":"static/webpack/static\\development\\pages\\be-part.js.559531508a9c98627774.hot-update.js","sources":["webpack:///./containers/BePart/BePart.tsx"],"sourcesContent":["import './BePart.scss'\r\nimport Button from '../../components/Button/Button'\r\nimport StyledInput from '../../components/Input/Input';\r\nimport { useState, ChangeEvent } from 'react';\r\nimport { Masks } from '../../utils/mask';\r\nimport Link from 'next/link';\r\nimport Router from 'next/router';\r\nimport { Validators } from '../../utils/validators';\r\n\r\nconst BePart = () => {\r\n    const [documentInput, setDocument] = useState('')\r\n    const [loading, setLoading] = useState(false)\r\n    const [mask, setMask] = useState(Masks.CPF)\r\n    const [shouldUpdateMask, setShouldUpdateMask] = useState(false)\r\n    const [userNotFound, setUserNotFound] = useState(false)\r\n    const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n        if (shouldUpdateMask) {\r\n            setMask(Masks.CNPJ)\r\n            setShouldUpdateMask(false)\r\n        }\r\n        setDocument(e.target.value)\r\n    }\r\n    const beforeMaskedValueChange = (values: any) => {\r\n        if (values.selection) {\r\n            const { end } = values.selection;\r\n            if (end === 14) {\r\n                setShouldUpdateMask(true)\r\n            }\r\n            if (mask === Masks.CNPJ && end === 13) {\r\n                setMask(Masks.CPF)\r\n            }\r\n        }\r\n        return {\r\n            ...values\r\n        }\r\n    }\r\n\r\n    const validateDocument = async () => {\r\n        const rawDocument = documentInput.replace(/\\D/g, '')\r\n        setLoading(true);\r\n        const field = rawDocument.length > 11 ? 'companyDocument' : 'contactDocument'\r\n        const res = await fetch(`${process.env.API_URL}/api/produtores/items?${field}=${rawDocument}&&`)\r\n        const data = await res.json();\r\n        setLoading(false)\r\n        if (data.length) {\r\n            const producer = data[0]\r\n\r\n            if (producer) {\r\n                setUserNotFound(false)\r\n                Router.push('/signup/update-producer/[id]', `/signup/update-producer/${producer.id}`)\r\n            }\r\n        } else {\r\n            setUserNotFound(true)\r\n            Router.push(`/signup/producer?notFound=true&document=${documentInput}`)\r\n        }\r\n    }\r\n    return (\r\n        <main className=\"be-part-container\">\r\n            <div>\r\n                <h1>Insira seu CPF ou CNPJ abaixo</h1>\r\n                <label>\r\n                Indique créditos trabalhistas elegíveis e ganhe conosco, por favor, insira seu CPF ou CNPJ:\r\n                </label>\r\n                <StyledInput\r\n                    mask={mask}\r\n                    beforeMaskedValueChange={beforeMaskedValueChange}\r\n                    placeholder=\"Ex: 111.111.111-11...\"\r\n                    value={documentInput}\r\n                    onChange={handleChange}\r\n                    className={userNotFound && 'not-found'}\r\n                />\r\n                {userNotFound && <span className=\"user-not-found\">Cadastro não encontrado</span>}\r\n                {documentInput.replace(/\\D/g,'').length === 11 && !Validators.cpf(documentInput) &&<span className=\"user-not-found\">CPF inválido</span>}\r\n                {documentInput.replace(/\\D/g,'').length === 14 && !Validators.cnpj(documentInput) &&<span className=\"user-not-found\">CNPJ inválido</span>}\r\n                <br/>\r\n               \r\n               \r\n            </div>\r\n        </main>\r\n    );\r\n\r\n}\r\nexport default BePart;    "],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAHA;AAAA;AACA;AADA;AAIA;AAJA;AAAA;AACA;AADA;AAKA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAkBA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AAAA;;;;;A","sourceRoot":""}