{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport RegisterForm from \"../../components/Register/RegisterForm\";\nimport { useState } from \"react\";\nimport ConfirmationChoice from \"../../components/Register/ConfirmationChoice/ConfirmationChoice\";\nimport Confirmation from \"../../components/Register/Confirmation/Confirmation\";\nimport AddressForm from \"../../components/Register/AddressForm/AddressForm\";\nimport RegisterSuccess from \"../../components/Register/RegisterSuccess/RegisterSuccess\";\n\nconst UpdateProducer = () => {\n  const {\n    0: step,\n    1: setStep\n  } = useState(0);\n  const {\n    0: userValues,\n    1: setUserValues\n  } = useState(null);\n  const {\n    0: confirmationChoice,\n    1: setConfirmationChoice\n  } = useState(null);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n\n  const handleUserSubmit = values => {\n    setUserValues(values);\n    setStep(1);\n  };\n\n  const handleConfimationChoice = choice => {\n    setConfirmationChoice(choice);\n    setStep(2);\n  };\n\n  const handleConfimation = value => {\n    setStep(3);\n  };\n\n  const handleAddressSubmit = async values => {\n    setLoading(true);\n    const addressString = `${values.address}, ${values.number}, ${values.city}, ${values.state}`;\n    const res = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${addressString}&key=AIzaSyD9birqocIzncUHjXSWIrx67UAT865gp84`);\n    const data = await res.json();\n    const {\n      lat,\n      lng\n    } = data.results[0].geometry.location;\n    await createProducer(_objectSpread({\n      address: `${values.address}, ${values.number}`,\n      city: values.city,\n      state: values.state\n    }, userValues, {\n      latitude: lat,\n      longitude: lng\n    }));\n    setStep(4);\n  };\n\n  const createProducer = async body => {\n    try {\n      const res = await fetch('https://api.organis8.com.br/api/produtores', {\n        method: 'POST',\n        body: JSON.stringify(body)\n      });\n      const data = await res.json();\n      return data;\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  switch (step) {\n    case 0:\n      return __jsx(RegisterForm, {\n        profile: \"producer\",\n        onSubmit: handleUserSubmit\n      });\n\n    case 1:\n      return __jsx(ConfirmationChoice, {\n        profile: \"producer\",\n        values: userValues,\n        onSubmit: handleConfimationChoice\n      });\n\n    case 2:\n      return __jsx(Confirmation, {\n        profile: \"producer\",\n        confirmationChoice: confirmationChoice,\n        onSubmit: handleConfimation\n      });\n\n    case 3:\n      return __jsx(AddressForm, {\n        profile: \"producer\",\n        loading: loading,\n        values: userValues,\n        onSubmit: handleAddressSubmit\n      });\n\n    case 4:\n      return __jsx(RegisterSuccess, null);\n  }\n};\n\nexport default UpdateProducer;","map":null,"metadata":{},"sourceType":"module"}